type Locale = "fr" | "en" | "de" | "es" | "zh" | "ja" | "ar" | "uk";

const translations: Record<Locale, Record<string, string>> = {
  fr: {
    app_title: "SignStamp",
    open_pdf: "Ouvrir un PDF",
    pages_singular: "page",
    pages_plural: "pages",
    zoom_out: "Zoom -",
    zoom_in: "Zoom +",
    tool_pan: "Déplacer",
    tool_text: "Texte",
    tool_date: "Date",
    tool_check: "Croix",
    tool_sign: "Signature",
    import_signature: "Importer signature",
    clear_all: "Tout effacer",
    export_pdf: "Exporter PDF",
    signatures: "Signatures",
    signatures_hint: "Importer une image PNG (idéal) ou JPG.",
    label_tool: "Outil",
    label_objects: "Objets",
    hint_line1: "Texte/Date: cliquer pour ajouter, double-clic pour éditer.",
    hint_line2: "Croix: cliquer pour poser. Signature: sélectionner puis cliquer pour poser.",
    hint_line3: "Glisser pour déplacer. Poignée pour redimensionner.",
    empty_hint: "Remplir et signer un PDF",
    empty_action: "Ouvrir un PDF",
    text_placeholder: "Texte...",
    text_prompt: "Texte:",
    edit_title: "Double-clic pour éditer",
    export_success: "PDF exporté vers:\n{path}",
    export_failed: "L'export a échoué pendant la génération du PDF. Consulte la console pour le détail.",
    export_tauri_failed: "L'export Tauri a échoué. Un téléchargement direct va être tenté.",
    no_pdf: "Aucun PDF chargé",
    file_label: "Fichier: {name}",
    export_note: "Export = PDF aplati (texte + image intégrés)"
  },
  en: {
    app_title: "SignStamp",
    open_pdf: "Open PDF",
    pages_singular: "page",
    pages_plural: "pages",
    zoom_out: "Zoom -",
    zoom_in: "Zoom +",
    tool_pan: "Move",
    tool_text: "Text",
    tool_date: "Date",
    tool_check: "Check",
    tool_sign: "Signature",
    import_signature: "Import signature",
    clear_all: "Clear all",
    export_pdf: "Export PDF",
    signatures: "Signatures",
    signatures_hint: "Import a PNG (ideal) or JPG image.",
    label_tool: "Tool",
    label_objects: "Objects",
    hint_line1: "Text/Date: click to add, double-click to edit.",
    hint_line2: "Check: click to place. Signature: select then click to place.",
    hint_line3: "Drag to move. Handle to resize.",
    empty_hint: "Fill and sign a PDF",
    empty_action: "Open a PDF",
    text_placeholder: "Text...",
    text_prompt: "Text:",
    edit_title: "Double-click to edit",
    export_success: "PDF exported to:\n{path}",
    export_failed: "Export failed while generating the PDF. See console for details.",
    export_tauri_failed: "Tauri export failed. A direct download will be attempted.",
    no_pdf: "No PDF loaded",
    file_label: "File: {name}",
    export_note: "Export = flattened PDF (text + image embedded)"
  },
  de: {
    app_title: "SignStamp",
    open_pdf: "PDF öffnen",
    pages_singular: "Seite",
    pages_plural: "Seiten",
    zoom_out: "Zoom -",
    zoom_in: "Zoom +",
    tool_pan: "Verschieben",
    tool_text: "Text",
    tool_date: "Datum",
    tool_check: "Kreuz",
    tool_sign: "Unterschrift",
    import_signature: "Signatur importieren",
    clear_all: "Alles löschen",
    export_pdf: "PDF exportieren",
    signatures: "Signaturen",
    signatures_hint: "PNG (ideal) oder JPG importieren.",
    label_tool: "Werkzeug",
    label_objects: "Objekte",
    hint_line1: "Text/Datum: klicken zum Hinzufügen, Doppelklick zum Bearbeiten.",
    hint_line2: "Kreuz: klicken zum Platzieren. Signatur: auswählen, dann klicken.",
    hint_line3: "Ziehen zum Verschieben. Griff zum Skalieren.",
    empty_hint: "Ein PDF ausfüllen und unterschreiben",
    empty_action: "PDF öffnen",
    text_placeholder: "Text...",
    text_prompt: "Text:",
    edit_title: "Doppelklick zum Bearbeiten",
    export_success: "PDF exportiert nach:\n{path}",
    export_failed: "Export fehlgeschlagen beim Erstellen des PDFs. Siehe Konsole für Details.",
    export_tauri_failed: "Tauri-Export fehlgeschlagen. Direkter Download wird versucht.",
    no_pdf: "Kein PDF geladen",
    file_label: "Datei: {name}",
    export_note: "Export = abgeflachtes PDF (Text + Bild eingebettet)"
  },
  es: {
    app_title: "SignStamp",
    open_pdf: "Abrir PDF",
    pages_singular: "página",
    pages_plural: "páginas",
    zoom_out: "Zoom -",
    zoom_in: "Zoom +",
    tool_pan: "Mover",
    tool_text: "Texto",
    tool_date: "Fecha",
    tool_check: "Marca",
    tool_sign: "Firma",
    import_signature: "Importar firma",
    clear_all: "Borrar todo",
    export_pdf: "Exportar PDF",
    signatures: "Firmas",
    signatures_hint: "Importa una imagen PNG (ideal) o JPG.",
    label_tool: "Herramienta",
    label_objects: "Objetos",
    hint_line1: "Texto/Fecha: clic para añadir, doble clic para editar.",
    hint_line2: "Marca: clic para colocar. Firma: selecciona y luego clic.",
    hint_line3: "Arrastra para mover. Asa para redimensionar.",
    empty_hint: "Rellenar y firmar un PDF",
    empty_action: "Abrir PDF",
    text_placeholder: "Texto...",
    text_prompt: "Texto:",
    edit_title: "Doble clic para editar",
    export_success: "PDF exportado a:\n{path}",
    export_failed: "La exportación falló al generar el PDF. Ver consola para detalles.",
    export_tauri_failed: "Falló la exportación con Tauri. Se intentará descarga directa.",
    no_pdf: "Ningún PDF cargado",
    file_label: "Archivo: {name}",
    export_note: "Exportar = PDF aplanado (texto + imagen incrustados)"
  },
  zh: {
    app_title: "SignStamp",
    open_pdf: "打开 PDF",
    pages_singular: "页",
    pages_plural: "页",
    zoom_out: "缩小",
    zoom_in: "放大",
    tool_pan: "移动",
    tool_text: "文本",
    tool_date: "日期",
    tool_check: "勾选",
    tool_sign: "签名",
    import_signature: "导入签名",
    clear_all: "全部清除",
    export_pdf: "导出 PDF",
    signatures: "签名",
    signatures_hint: "导入 PNG（推荐）或 JPG 图片。",
    label_tool: "工具",
    label_objects: "对象",
    hint_line1: "文本/日期：点击添加，双击编辑。",
    hint_line2: "勾选：点击放置。签名：选择后点击放置。",
    hint_line3: "拖动移动。拖拽手柄缩放。",
    empty_hint: "填写并签署 PDF",
    empty_action: "打开 PDF",
    text_placeholder: "文本...",
    text_prompt: "文本：",
    edit_title: "双击编辑",
    export_success: "PDF 已导出到：\n{path}",
    export_failed: "生成 PDF 时导出失败。详见控制台。",
    export_tauri_failed: "Tauri 导出失败，将尝试直接下载。",
    no_pdf: "未加载 PDF",
    file_label: "文件：{name}",
    export_note: "导出 = 扁平化 PDF（文本 + 图片嵌入）"
  },
  ja: {
    app_title: "SignStamp",
    open_pdf: "PDFを開く",
    pages_singular: "ページ",
    pages_plural: "ページ",
    zoom_out: "ズームアウト",
    zoom_in: "ズームイン",
    tool_pan: "移動",
    tool_text: "テキスト",
    tool_date: "日付",
    tool_check: "チェック",
    tool_sign: "署名",
    import_signature: "署名を読み込む",
    clear_all: "すべて消去",
    export_pdf: "PDFを書き出す",
    signatures: "署名",
    signatures_hint: "PNG（推奨）または JPG 画像を読み込んでください。",
    label_tool: "ツール",
    label_objects: "オブジェクト",
    hint_line1: "テキスト/日付：クリックで追加、ダブルクリックで編集。",
    hint_line2: "チェック：クリックで配置。署名：選択してクリック。",
    hint_line3: "ドラッグで移動。ハンドルでサイズ変更。",
    empty_hint: "PDFを入力して署名する",
    empty_action: "PDFを開く",
    text_placeholder: "テキスト...",
    text_prompt: "テキスト：",
    edit_title: "ダブルクリックで編集",
    export_success: "PDF を書き出しました：\n{path}",
    export_failed: "PDF の生成中に書き出しに失敗しました。コンソールを確認してください。",
    export_tauri_failed: "Tauri の書き出しに失敗しました。直接ダウンロードを試みます。",
    no_pdf: "PDF 未読み込み",
    file_label: "ファイル：{name}",
    export_note: "書き出し = フラット化PDF（テキスト + 画像埋め込み）"
  },
  ar: {
    app_title: "SignStamp",
    open_pdf: "فتح PDF",
    pages_singular: "صفحة",
    pages_plural: "صفحات",
    zoom_out: "تصغير",
    zoom_in: "تكبير",
    tool_pan: "تحريك",
    tool_text: "نص",
    tool_date: "تاريخ",
    tool_check: "علامة",
    tool_sign: "توقيع",
    import_signature: "استيراد توقيع",
    clear_all: "مسح الكل",
    export_pdf: "تصدير PDF",
    signatures: "التواقيع",
    signatures_hint: "استيراد صورة PNG (مفضل) أو JPG.",
    label_tool: "الأداة",
    label_objects: "العناصر",
    hint_line1: "نص/تاريخ: انقر للإضافة، انقر مرتين للتعديل.",
    hint_line2: "علامة: انقر للوضع. توقيع: اختر ثم انقر.",
    hint_line3: "اسحب للتحريك. المقبض لتغيير الحجم.",
    empty_hint: "تعبئة وتوقيع ملف PDF",
    empty_action: "فتح PDF",
    text_placeholder: "نص...",
    text_prompt: "نص:",
    edit_title: "انقر مرتين للتعديل",
    export_success: "تم تصدير PDF إلى:\n{path}",
    export_failed: "فشل التصدير أثناء إنشاء PDF. راجع وحدة التحكم للتفاصيل.",
    export_tauri_failed: "فشل تصدير Tauri. سيتم محاولة تنزيل مباشر.",
    no_pdf: "لا يوجد PDF محمّل",
    file_label: "الملف: {name}",
    export_note: "التصدير = PDF مسطح (نص + صورة مدمجة)"
  },
  uk: {
    app_title: "SignStamp",
    open_pdf: "Відкрити PDF",
    pages_singular: "сторінка",
    pages_plural: "сторінок",
    zoom_out: "Зменшити",
    zoom_in: "Збільшити",
    tool_pan: "Перемістити",
    tool_text: "Текст",
    tool_date: "Дата",
    tool_check: "Хрестик",
    tool_sign: "Підпис",
    import_signature: "Імпортувати підпис",
    clear_all: "Очистити все",
    export_pdf: "Експорт PDF",
    signatures: "Підписи",
    signatures_hint: "Імпортуйте PNG (краще) або JPG.",
    label_tool: "Інструмент",
    label_objects: "Обʼєкти",
    hint_line1: "Текст/Дата: клік — додати, подвійний клік — редагувати.",
    hint_line2: "Хрестик: клік — поставити. Підпис: виберіть і клікніть.",
    hint_line3: "Перетягування для переміщення. Ручка — змінити розмір.",
    empty_hint: "Заповнити та підписати PDF",
    empty_action: "Відкрити PDF",
    text_placeholder: "Текст...",
    text_prompt: "Текст:",
    edit_title: "Подвійний клік для редагування",
    export_success: "PDF експортовано до:\n{path}",
    export_failed: "Експорт не вдався під час створення PDF. Дивіться консоль.",
    export_tauri_failed: "Експорт Tauri не вдався. Буде спроба прямого завантаження.",
    no_pdf: "PDF не завантажено",
    file_label: "Файл: {name}",
    export_note: "Експорт = плаский PDF (текст + зображення вбудовано)"
  }
};

export function detectLocale(): Locale {
  const raw = (navigator.languages?.[0] || navigator.language || "en").toLowerCase();
  if (raw.startsWith("fr")) return "fr";
  if (raw.startsWith("en")) return "en";
  if (raw.startsWith("de")) return "de";
  if (raw.startsWith("es")) return "es";
  if (raw.startsWith("zh")) return "zh";
  if (raw.startsWith("ja")) return "ja";
  if (raw.startsWith("ar")) return "ar";
  if (raw.startsWith("uk")) return "uk";
  return "en";
}

export function makeTranslator(locale: Locale) {
  return (key: string) => translations[locale]?.[key] ?? translations.en[key] ?? key;
}

export function formatLocaleDate(locale: Locale, date: Date) {
  return new Intl.DateTimeFormat(locale, { day: "2-digit", month: "2-digit", year: "numeric" }).format(date);
}

export function getDirection(locale: Locale) {
  return locale === "ar" ? "rtl" : "ltr";
}
